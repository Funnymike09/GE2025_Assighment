[gd_scene load_steps=37 format=3 uid="uid://crmot4j22fltw"]

[ext_resource type="PackedScene" uid="uid://ivslos3b7cmv" path="res://behaviors/player.tscn" id="1_6tak8"]
[ext_resource type="Script" uid="uid://bb475dsswmiyu" path="res://behaviors/spine_animator.gd" id="2_xmup5"]
[ext_resource type="Script" uid="uid://cmw6n17mebkcx" path="res://behaviors/boid.gd" id="3_5ag7w"]
[ext_resource type="Script" uid="uid://h5wrviq7ex0m" path="res://behaviors/offset_pursue.gd" id="3_6tak8"]
[ext_resource type="Material" uid="uid://b2raijlysriqd" path="res://behaviors/Tank Material.tres" id="4_qaut4"]
[ext_resource type="Script" uid="uid://s5pb8njisohn" path="res://behaviors/avoidance.gd" id="5_gfsgr"]
[ext_resource type="Script" uid="uid://bctpwo8cerrgq" path="res://behaviors/harmonic.gd" id="6_6tak8"]
[ext_resource type="ArrayMesh" uid="uid://bfuehokv23s13" path="res://WhaleRoom_Mike/TailMesh.res" id="6_r735p"]
[ext_resource type="Script" uid="uid://ci8facjqq07ft" path="res://behaviors/constrain.gd" id="7_5y5xs"]
[ext_resource type="Script" uid="uid://bqb47mif0r5vt" path="res://behaviors/noise_wander.gd" id="8_0dhei"]
[ext_resource type="Script" uid="uid://b6jj7yxhu2hi1" path="res://behaviors/follow_path.gd" id="9_bnf3l"]
[ext_resource type="Script" uid="uid://c2d7mphmtn1jv" path="res://behaviors/seek.gd" id="10_r735p"]
[ext_resource type="Script" uid="uid://bn4xj07get8k6" path="res://behaviors/arrive.gd" id="11_vhrcu"]
[ext_resource type="Script" uid="uid://cqk70j8jant4u" path="res://behaviors/player_steering.gd" id="12_mbhyr"]
[ext_resource type="Material" uid="uid://dfso08a0ar4sp" path="res://WhaleRoom_Mike/Bowl mat.tres" id="13_0dhei"]
[ext_resource type="Script" path="res://WhaleRoom_Mike/Final Room/audio_breach.gd" id="15_mbhyr"]
[ext_resource type="Shader" uid="uid://bk3qg5vr1b32i" path="res://WhaleRoom_Mike/Glass.gdshader" id="15_r735p"]
[ext_resource type="ArrayMesh" uid="uid://krl3646k5n8o" path="res://WhaleRoom_Mike/HeadMesh.res" id="15_vhrcu"]
[ext_resource type="ArrayMesh" uid="uid://wvgl642sgvg7" path="res://WhaleRoom_Mike/BodyWhale.res" id="17_mbhyr"]
[ext_resource type="ArrayMesh" uid="uid://dg167bjpr2b32" path="res://WhaleRoom_Mike/Final Room/Bowl2.obj" id="18_mbhyr"]
[ext_resource type="Material" uid="uid://baw1fa3du13xh" path="res://WhaleRoom_Mike/polyWatar.tres" id="19_n2pol"]
[ext_resource type="PackedScene" uid="uid://cum5ivwqduljn" path="res://WhaleRoom_Mike/Final Room/bowle_insider.tscn" id="22_vhrcu"]

[sub_resource type="SphereShape3D" id="SphereShape3D_6tak8"]

[sub_resource type="Curve3D" id="Curve3D_dvjpt"]
resource_local_to_scene = true
closed = true
bake_interval = 0.01
_data = {
"points": PackedVector3Array(0, 0, 0, 0, 0, 0, -2.3354, -16.3986, -17.3078, 0, 0, 0, 0, 0, 0, 3.1149, 11.4366, 12.9386, 0, 0, 0, 0, 0, 0, 19.9973, 14.3196, -16.3176, 0, 0, 0, 0, 0, 0, 0, 0.25129, -29.1026, 0, 0, 0, 0, 0, 0, -18.8987, 1.65761, -20.1716, 0, 0, 0, 0, 0, 0, -0.387939, 19.2248, 1.86348, 0, 0, 0, 0, 0, 0, 3.60519, 17.5299, 6.44719, 0, 0, 0, 0, 0, 0, 11.9477, 0, -17.5351, 0, 0, 0, 0, 0, 0, -6.4151, 6.37463, -7.76931, 0, 0, 0, 0, 0, 0, -3.9078, 14.9947, -16.2798, 0, 0, 0, 0, 0, 0, 1.7717, 19.5008, -16.7962, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
"tilts": PackedFloat32Array(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
}
point_count = 13

[sub_resource type="Gradient" id="Gradient_bnf3l"]
offsets = PackedFloat32Array(0, 0.507246, 1)
colors = PackedColorArray(0.227451, 0.321569, 0.545098, 1, 0.767486, 0.628285, 0.612388, 1, 1, 1, 1, 1)

[sub_resource type="FastNoiseLite" id="FastNoiseLite_r735p"]
frequency = 0.0085

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_vhrcu"]
seamless = true
color_ramp = SubResource("Gradient_bnf3l")
noise = SubResource("FastNoiseLite_r735p")

[sub_resource type="PanoramaSkyMaterial" id="PanoramaSkyMaterial_mbhyr"]
panorama = SubResource("NoiseTexture2D_vhrcu")

[sub_resource type="Sky" id="Sky_2l1ob"]
sky_material = SubResource("PanoramaSkyMaterial_mbhyr")

[sub_resource type="Environment" id="Environment_08sxa"]
background_mode = 2
sky = SubResource("Sky_2l1ob")
reflected_light_source = 2
tonemap_mode = 2
glow_enabled = true
volumetric_fog_enabled = true
volumetric_fog_density = 0.0
volumetric_fog_albedo = Color(0, 0, 0.756863, 1)
volumetric_fog_emission = Color(0.14902, 0.301961, 0.635294, 1)
volumetric_fog_emission_energy = 0.1
volumetric_fog_anisotropy = 0.37

[sub_resource type="BoxShape3D" id="BoxShape3D_1mhke"]

[sub_resource type="BoxShape3D" id="BoxShape3D_u464f"]

[sub_resource type="BoxShape3D" id="BoxShape3D_gk2eq"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_n2pol"]
render_priority = 0
shader = ExtResource("15_r735p")
shader_parameter/albedo = Color(1, 1, 1, 0)
shader_parameter/roughness = 0.15
shader_parameter/normal_strength = 1.0
shader_parameter/edge_color = Color(0, 0, 0, 1)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_bnf3l"]
points = PackedVector3Array(0.151871, -0.13976, 0.971938, -0.182726, -0.108617, -0.975114, -0.18298, 0.105407, -0.976467, 0.976471, 0.105408, -0.182945, 0.297766, -0.947862, -0.0891631, -0.916702, 0.289462, 0.27488, -0.625932, -0.769717, 0.119148, 0.787589, 0.283837, 0.545132, 0.545304, 0.283913, -0.787528, 0.535681, -0.64991, 0.535576, -0.717809, -0.471879, -0.508364, 0.32617, -0.648781, -0.68174, -0.326166, -0.648777, 0.681732, -0.364441, 0.285607, 0.880765, -0.786879, 0.283264, -0.544641, 0.874699, -0.44273, -0.1808, -0.237383, -0.767709, -0.593248, -0.936978, -0.261737, 0.211479, -0.659604, -0.292535, 0.689528, 0.815835, -0.17105, 0.543846, -0.0896811, -0.979934, 0.149377, 0.544056, -0.171016, -0.81583, 0.366011, 0.288355, 0.884559, -0.975121, -0.108616, -0.182692, 0.119164, -0.769691, 0.625957, 0.152319, 0.287509, -0.944268, -0.181518, -0.291961, 0.938323, -0.544066, -0.171012, -0.815845, 0.884614, 0.28827, -0.36589, -0.354952, -0.884863, -0.295767, 0.748932, -0.62197, 0.209622, 0.975106, -0.108619, 0.182689)

[sub_resource type="PlaneMesh" id="PlaneMesh_08sxa"]
lightmap_size_hint = Vector2i(152, 152)
size = Vector2(30, 30)
subdivide_width = 32
subdivide_depth = 16

[node name="Submit" type="Node3D"]

[node name="Player" parent="." node_paths=PackedStringArray("env", "Surface") instance=ExtResource("1_6tak8")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0.888981)
env = NodePath("../WorldEnvironment")
Surface = NodePath("../CSGSphere3D/Bowl2/Node3D")

[node name="Area3D" type="Area3D" parent="Player"]

[node name="CollisionShape3D2" type="CollisionShape3D" parent="Player/Area3D"]
shape = SubResource("SphereShape3D_6tak8")

[node name="deepwata" type="FmodEventEmitter3D" parent="Player"]
event_name = "event:/Amiance/Deep wata"
event_guid = "{9d007e38-2a36-4da5-b949-7f2d4db09901}"

[node name="Surfaces" type="FmodEventEmitter3D" parent="Player"]
event_name = "event:/Amiance/Surface 2"
event_guid = "{01c07798-4d77-4d0e-8b30-806a28071162}"
autoplay = true
fmod_parameters/Deep/id = 7281973838695930277
fmod_parameters/Deep = 0.0
fmod_parameters/Deep/variant_type = 3

[node name="FmodListener3D" type="FmodListener3D" parent="Player"]

[node name="camera follower" type="CharacterBody3D" parent="."]
script = ExtResource("3_5ag7w")
max_force = 30
draw_gizmos = false

[node name="offset_pursue" type="Node" parent="camera follower" node_paths=PackedStringArray("leader_boid")]
script = ExtResource("3_6tak8")
leader_boid = NodePath("../../creature/boid")
weight = 5.0

[node name="Avoidance" type="Node" parent="camera follower"]
script = ExtResource("5_gfsgr")

[node name="centra" type="Marker3D" parent="."]

[node name="Path3D" type="Path3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -9.66712, 13.4197)
curve = SubResource("Curve3D_dvjpt")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_08sxa")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.997441, 0.0653172, 0.0290714, 0.0251451, -0.0601685, 0.997871, 0.0669264, 0.996049, 0.0583726, 0, 0, 0)
shadow_enabled = true

[node name="creature" type="Node" parent="."]

[node name="spineanimator" type="Node" parent="creature" node_paths=PackedStringArray("bones")]
script = ExtResource("2_xmup5")
bones = [NodePath("../boid"), NodePath("../body1"), NodePath("../tail")]

[node name="boid" type="CharacterBody3D" parent="creature"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.489376, -1.56087, 2.68076)
script = ExtResource("3_5ag7w")
max_speed = 5.0
banking = 0.07
damping = 0.3

[node name="MeshInstance3D" type="MeshInstance3D" parent="creature/boid"]
transform = Transform3D(-1.57361e-05, -120, 1.57361e-05, 4.58564e-13, 1.57361e-05, 120, -120, 1.57361e-05, -1.60498e-12, 0, 0, -0.182533)
mesh = ExtResource("15_vhrcu")
skeleton = NodePath("../../..")
surface_material_override/0 = ExtResource("4_qaut4")

[node name="CollisionShape3D" type="CollisionShape3D" parent="creature/boid"]
shape = SubResource("BoxShape3D_1mhke")

[node name="Avoidance" type="Node" parent="creature/boid"]
script = ExtResource("5_gfsgr")

[node name="Harmonic" type="Node" parent="creature/boid"]
script = ExtResource("6_6tak8")

[node name="Constrain" type="Node" parent="creature/boid"]
script = ExtResource("7_5y5xs")
radius = 60.0
center_path = NodePath("../../../centra")
weight = 0.5

[node name="NoiseWander" type="Node" parent="creature/boid"]
script = ExtResource("8_0dhei")
draw_gizmos = false

[node name="PathFollow3D" type="Node" parent="creature/boid" node_paths=PackedStringArray("path")]
script = ExtResource("9_bnf3l")
path = NodePath("../../../Path3D")
weight = 3.0

[node name="Seek" type="Node" parent="creature/boid"]
script = ExtResource("10_r735p")
draw_gizmos = false
enabled = false

[node name="Arrive" type="Node" parent="creature/boid"]
script = ExtResource("11_vhrcu")
draw_gizmos = false
enabled = false

[node name="UserSteering" type="Node" parent="creature/boid"]
script = ExtResource("12_mbhyr")
draw_gizmos = false
enabled = false

[node name="audioBreach" type="Node" parent="creature/boid" node_paths=PackedStringArray("out", "land")]
script = ExtResource("15_mbhyr")
out = NodePath("../Out")
land = NodePath("../In")

[node name="Area3D" type="Area3D" parent="creature/boid/audioBreach"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.489376, -1.56087, 2.68076)

[node name="CollisionShape3D2" type="CollisionShape3D" parent="creature/boid/audioBreach/Area3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0.986876)
shape = SubResource("SphereShape3D_6tak8")

[node name="Swiminge" type="FmodEventEmitter3D" parent="creature/boid"]
event_name = "event:/Whale/Swimming"
event_guid = "{414bc5bb-5b52-46f8-9f37-27e2594b3d47}"
autoplay = true

[node name="Out" type="FmodEventEmitter3D" parent="creature/boid"]
event_name = "event:/Whale/Breaching"
event_guid = "{0adb978e-efeb-45d4-ae75-719b655ba8a3}"
fmod_parameters/Deep/id = 7281973838695930277
fmod_parameters/Deep = 0.0
fmod_parameters/Deep/variant_type = 3

[node name="In" type="FmodEventEmitter3D" parent="creature/boid"]
event_name = "event:/Whale/LandW"
event_guid = "{36bb8490-5f21-444f-910b-ee88bba72ab6}"
fmod_parameters/Deep/id = 7281973838695930277
fmod_parameters/Deep = 0.0
fmod_parameters/Deep/variant_type = 3

[node name="sounds" type="FmodEventEmitter3D" parent="creature/boid"]
event_name = "event:/Whale/Moan"
event_guid = "{f24b690e-553d-490e-bd35-8977556abd3d}"
autoplay = true

[node name="Exhale" type="FmodEventEmitter3D" parent="creature/boid"]
event_name = "event:/Whale/SurfaceExhale"
event_guid = "{ee887040-35ef-4428-ae10-8b1393bc2291}"
fmod_parameters/Deep/id = 7281973838695930277
fmod_parameters/Deep = 0.0
fmod_parameters/Deep/variant_type = 3

[node name="tail" type="CharacterBody3D" parent="creature"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.489376, -1.56087, -0.63224)

[node name="MeshInstance3D" type="MeshInstance3D" parent="creature/tail"]
transform = Transform3D(1.57361e-05, -143.76, -5.24537e-06, 2.5411e-20, -6.28395e-06, 120, -120, -1.88518e-05, -6.87847e-13, 0, 0, -0.131317)
mesh = ExtResource("6_r735p")
skeleton = NodePath("")
surface_material_override/0 = ExtResource("4_qaut4")

[node name="CollisionShape3D" type="CollisionShape3D" parent="creature/tail"]
shape = SubResource("BoxShape3D_u464f")
disabled = true

[node name="body1" type="CharacterBody3D" parent="creature"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.489376, -1.56087, 0.754562)

[node name="MeshInstance4" type="MeshInstance3D" parent="creature/body1"]
transform = Transform3D(-5.24537e-06, -120, -5.24537e-06, 2.5411e-20, -5.24537e-06, 120, -120, 5.24537e-06, 2.29282e-13, 0, 0, 0)
mesh = ExtResource("17_mbhyr")
skeleton = NodePath("../../..")
surface_material_override/0 = ExtResource("4_qaut4")

[node name="CollisionShape3D" type="CollisionShape3D" parent="creature/body1"]
shape = SubResource("BoxShape3D_gk2eq")

[node name="CSGSphere3D" type="CSGSphere3D" parent="."]
material_override = SubResource("ShaderMaterial_n2pol")
radius = 30.0
radial_segments = 64
rings = 32
material = ExtResource("13_0dhei")

[node name="CSGBox3D" type="CSGBox3D" parent="CSGSphere3D"]
transform = Transform3D(10.0905, 0, 0, 0, 16.1703, 0, 0, 0, 17.7982, -3.01737, 22.95, -0.0520096)
operation = 2
flip_faces = true
size = Vector3(5.92004, 1.02954, 3.09174)

[node name="Bowl2" type="MeshInstance3D" parent="CSGSphere3D"]
transform = Transform3D(26.958, 0, 0, 0, 26.958, 0, 0, 0, 26.958, 0.170817, -0.93481, 0.493706)
mesh = ExtResource("18_mbhyr")
skeleton = NodePath("../..")
surface_material_override/0 = ExtResource("19_n2pol")

[node name="Area3D" type="Area3D" parent="CSGSphere3D/Bowl2"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="CSGSphere3D/Bowl2/Area3D"]
shape = SubResource("ConvexPolygonShape3D_bnf3l")
debug_color = Color(0.867808, 0.150859, 0.778591, 0.42)

[node name="Node3D" type="Node3D" parent="CSGSphere3D/Bowl2"]
transform = Transform3D(189.968, 0, 0, 0, 1, 0, 0, 0, 182.068, 0, 0.317511, 0)

[node name="bowleInsider" parent="CSGSphere3D/Bowl2" instance=ExtResource("22_vhrcu")]
transform = Transform3D(0.065, 0, 0, 0, 0.065, 0, 0, 0, 0.065, 0, -0.216076, 0)

[node name="MeshInstance3D3" type="MeshInstance3D" parent="."]
transform = Transform3D(1.67421, 0, 0, 0, 1.67421, 0, 0, 0, 1.67421, -63.0445, 17.2327, 76.7189)
material_override = ExtResource("19_n2pol")
mesh = SubResource("PlaneMesh_08sxa")

[node name="FmodBankLoader" type="FmodBankLoader" parent="."]
bank_paths = ["res://FmodBank/Desktop/WATAS.bank", "res://FmodBank/Desktop/Master.strings.bank"]

[connection signal="area_entered" from="CSGSphere3D/Bowl2/Area3D" to="Player" method="_on_area_3d_area_entered"]
[connection signal="area_entered" from="CSGSphere3D/Bowl2/Area3D" to="creature/boid/audioBreach" method="_on_area_3d_area_entered"]
[connection signal="area_exited" from="CSGSphere3D/Bowl2/Area3D" to="Player" method="_on_area_3d_area_exited"]
[connection signal="area_exited" from="CSGSphere3D/Bowl2/Area3D" to="creature/boid/audioBreach" method="_on_area_3d_area_exited"]
